name: version_change

on: [workflow_dispatch]

jobs:
    version_check:

        runs-on: ubuntu-latest

        permissions:
            contents: write
            pull-requests: write

        steps:
            - name: Write branch and commit info
              run: |
                branch=$(git rev-parse --abbrev-ref HEAD)
                hash=$(git rev-parse --short=8 HEAD)
                echo "$branch.$hash" > version.txt
            
            - name: Checkout Repository
              uses: actions/checkout@v4
              with:
                token: ${{ secrets.PAT }}
                submodules: recursive
      
            - name: Authorize Git
              run: |
                git config --global user.email "$GITHUB_ACTOR@users.noreply.github.com"
                git config --global user.name "$GITHUB_ACTOR"
      
            - name: Update Submodule
              run: |
                git submodule update  --init --recursive --remote -f
              env:
                GITHUB_TOKEN: ${{ secrets.PAT }}
      
            - name: Commit Changes
              run: |
                git commit -am "chore(submodule): Update Translation Data"
                git push origin main
              env:
                GITHUB_TOKEN: ${{ secrets.PAT }}